<!doctype html>
<html>
	<head>
		<!--Include the jmat library-->
		<script src="jmat.js"> </script>
		<!--This exports script is needed for the erf function to work properly-->
		<script> var exports = {}; </script>
		<script src="MathFn/functions/erf.js"></script>
	</head>
	<body>
	</body>
	<script>
		
		//Test for psychometric fit
		var x = [0.1, 0.3, 0.5, 0.7, 0.9];
		var y = [0.0, 0.05, 0.5, 0.95, 1.0];
		
		console.log(fitCumulativeGaussian(x,y));
		
		function fitCumulativeGaussian(xArray,yArray,initialGuessArray = [0.5,1,0,0]){
			
			
			//p is the initial guess array, for easy handling
			var p = initialGuessArray;
			
			/*
			Parameters and what they mean:
			p[0] = alpha  = bias/mean
			p[1] = beta   = slope
			p[2] = gamma  = guess rate
			p[3] = lambda = lapse rate
			*/
			//The psychometric fit function for cumulative gaussian
			var cumulativeGaussianFunction = function(xArray,p){
				return xArray.map(
					function(xValue){
						return ( p[2]+(1-p[2]-p[3])*0.5*(erfc((-p[1])*(xValue-p[0])/Math.sqrt(2))) );
					}
				);
			};
			
			//Calculate the parameters with fminsearch
			var output = jmat.fminsearch(cumulativeGaussianFunction,[0.5,1,0,0],x,y);
			
			//Return the parameters
			return output;
				
		}//End of fitCumulativeGaussian

		



	</script>
</html>